{% extends "base.html" %}
{% block content %}
<section class="hero">
  <div class="dashboard-container">

    <h2 style="color:#016A70; text-align:center; margin-bottom:24px;">Analytics & Stats</h2>

    <!-- Top stats cards -->
    <div class="grid stats-grid">
      <div class="card" style="background:#016A70; color:#FFFFDD;">
        <h3>Total Products</h3>
        <p>{{ total_products }}</p>
      </div>
      <div class="card" style="background:#D2DE32; color:#016A70;">
        <h3>Your Products</h3>
        <p>{{ user_products }}</p>
      </div>
      <div class="card" style="background:#A2C579; color:#016A70;">
        <h3>Temperature Violations</h3>
        <p>{{ temp_violations }}</p>
      </div>
      <div class="card" style="background:#FFFFDD; color:#016A70;">
        <h3>Humidity Violations</h3>
        <p>{{ humidity_violations }}</p>
      </div>
    </div>

    <!-- Food Safety -->
    <h3 style="margin-top:32px; color:#016A70;">Food Safety</h3>
    <div class="grid charts-grid" style="margin-top:16px; gap:24px;">
      <div class="card">
        <h4>Temperature & Humidity Over Time</h4>
        <div id="safety-line-chart" data-json='{{ safety_line_json | tojson | safe }}'></div>
      </div>
      <div class="card">
        <h4>Violations per Owner</h4>
        <div id="violations-bar-chart" data-json='{{ violations_bar_json | tojson | safe }}'></div>
      </div>
      <div class="card">
        <h4>Risky Locations Heatmap</h4>
        <div id="heatmap-chart" data-json='{{ heatmap_json | tojson | safe }}'></div>
      </div>
    </div>

    <!-- Fraud Detection -->
    <h3 style="margin-top:32px; color:#016A70;">Fraud Detection</h3>
    <div class="grid charts-grid" style="margin-top:16px; gap:24px;">
      <div class="card">
        <h4>Unusual Ownership Changes</h4>
        <div id="fraud-pie-chart" data-json='{{ fraud_pie_json | tojson | safe }}'></div>
      </div>
      <div class="card">
        <h4>Transport Time vs Distance</h4>
        <div id="fraud-scatter-chart" data-json='{{ fraud_scatter_json | tojson | safe }}'></div>
      </div>
      <div class="card">
        <h4>Ownership Network</h4>
        <div id="fraud-network-chart" data-json='{{ fraud_network_json | tojson | safe }}'></div>
      </div>
    </div>

    <!-- Supply Chain Performance -->
    <h3 style="margin-top:32px; color:#016A70;">Supply Chain Performance</h3>
    <div class="grid charts-grid" style="margin-top:16px; gap:24px;">
      <div class="card">
        <h4>Products per Stakeholder</h4>
        <div id="performance-bar-chart" data-json='{{ performance_bar_json | tojson | safe }}'></div>
      </div>
      <div class="card">
        <h4>Product Status Distribution</h4>
        <div id="performance-stacked-chart" data-json='{{ performance_stacked_json | tojson | safe }}'></div>
      </div>
      <div class="card">
        <h4>Average Transport Duration</h4>
        <div id="performance-timeline-chart" data-json='{{ performance_timeline_json | tojson | safe }}'></div>
      </div>
    </div>

  </div>
</section>

<!-- Plotly JS -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="{{ url_for('static', filename='js/analytics.js') }}"></script>
{% endblock %}
